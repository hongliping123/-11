<template>
	<view>
		<!-- è¯é¢˜æ¥å— -->
		<topic-info :item="topicInfo"></topic-info>
		<!-- tabbaråˆ‡æ¢ -->
		<swiper-tab-head
		:tabBars="tabBars"
		:tabIndex="tabIndex"
		@tobtap="tobtap"
		scrollWidth="width: 50%;"
		scrollStyle="border-bottom:0;"
		>
		</swiper-tab-head>
		<!-- åˆ—è¡¨ -->
		<view class="topic-detail-list">
			<block v-for="(item,index) in tablist" :key="index">
				<template v-if="tabIndex == index">
					<!-- åˆ—è¡¨ -->
					<block  v-for="(list,listindex) in item.list" :key="listindex">
						<common-list :item="list" :index="listindex"></common-list>
					</block>
					<!-- ä¸Šæ‹‰åŠ è½½ -->
					<load-more :loadtext="item.loadtext"></load-more>
				</template>
			</block>
		</view>
	</view>
</template>

<script>
	import topicInfo from "../../components/topic/topic-info.vue"
	import swiperTabHead from "../../components/index/swiper-tab-head.vue"
	import commonList from "../../components/common/common-list.vue"
	import loadMore from "../../components/common/load-more.vue"
	export default {
		components:{
			topicInfo,
			swiperTabHead,
			commonList,
			loadMore
		},
		
		data() {
			return {
				tabIndex:0,
				tabBars:[
					{ name:"é»˜è®¤",id:"moren" },
					{ name:"æœ€æ–°",id:"zuixing" }
				],
				topicInfo:{
						titlepic:"../../static/demo/datapic/13.jpg",
						title:"å¿†å¾€äº‹ æ•¬ä½™ç”Ÿ",
						dese:"æˆ‘æ˜¯æè¿°",
						totalnum:"12",
						todaynum:"13"
				},
				tablist:[
					{
						loadtext:"åŠ è½½æ›´å¤š",
						list:[
							{
								userpic:"../../static/demo/userpic/10.jpg",
								username:"ä¸‰é±¼å…ˆç”Ÿ",
								sex:0, // 0ç”· 1å¥³
								age:25,
								isguanzhu:false,
								title:"æˆ‘æ˜¯æ ‡é¢˜",
								titleepic:"",
								video:false,
								shaer:false,
								path:"æ·±åœ³ ç½—æ¹–",
								shaernum:20,
								commonnum:30,
								goodnum:50
							},	// å›¾æ–‡
							{
								userpic:"../../static/demo/userpic/10.jpg",
								username:"ä¸‰é±¼å…ˆç”Ÿ",
								sex:1, // 0ç”· 1å¥³
								age:25,
								isguanzhu:false,
								title:"æˆ‘æ˜¯æ ‡é¢˜",
								titleepic:"../../static/demo/datapic/14.jpg",
								video:false,
								shaer:false,
								path:"æ·±åœ³ ç½—æ¹–",
								shaernum:20,
								commonnum:30,
								goodnum:50
							},
						]
					},
					{
						loadtext:"åŠ è½½æ›´å¤š",
						list:[
							{
								userpic:"../../static/demo/userpic/10.jpg",
								username:"ä¸‰é±¼å…ˆç”Ÿ",
								sex:0, // 0ç”· 1å¥³
								age:25,
								isguanzhu:false,
								title:"æˆ‘æ˜¯æ ‡é¢˜",
								titleepic:"",
								video:false,
								shaer:false,
								path:"æ·±åœ³ ç½—æ¹–",
								shaernum:20,
								commonnum:30,
								goodnum:50
							},	// å›¾æ–‡
							{
								userpic:"../../static/demo/userpic/10.jpg",
								username:"ä¸‰é±¼å…ˆç”Ÿ",
								sex:1, // 0ç”· 1å¥³
								age:25,
								isguanzhu:false,
								title:"æˆ‘æ˜¯æ ‡é¢˜",
								titleepic:"../../static/demo/datapic/14.jpg",
								video:false,
								shaer:false,
								path:"æ·±åœ³ ç½—æ¹–",
								shaernum:20,
								commonnum:30,
								goodnum:50
							},
						]
					}
				]
			}
		},
		 
		// é¡µé¢ä¸Šæ‹‰è§¦åº•äº‹ä»¶
		onReachBottom(){
			// ä¸Šæ‹‰åŠ è½½
			this.loadmore()
			
		},
		// ç›‘å¬ä¸‹æ‹‰åˆ·æ–°äº‹ä»¶
		onPullDownRefresh() {
			// ä¸Šæ‹‰åˆ·æ–°
			this.getdata()
		},
		methods: {
			// ä¸Šæ‹‰åˆ·æ–°
			getdata(){
				setTimeout(()=> {
					// è·å–æ•°æ®
					let arr= [
								{
									userpic:"../../static/demo/userpic/10.jpg",
									username:"ä¸€åªè‹±ä¿Šçš„å°é©¬",
									sex:1, // 0ç”· 1å¥³
									age:30,
									isguanzhu:true,
									title:"æˆ‘æ˜¯ä¸€åªåœ¨è‰åŸä¸Šå¥”è·‘çš„å°ğŸ",
									titleepic:"",
									video:false,
									shaer:false,
									path:"æ¹–å— è¡¡é˜³",
									shaernum:20,
									commonnum:30,
									goodnum:50
								},	// å›¾æ–‡
								{
									userpic:"../../static/demo/userpic/10.jpg",
									username:"ä¸‰é±¼å…ˆç”Ÿ",
									sex:1, // 0ç”· 1å¥³
									age:25,
									isguanzhu:false,
									title:"æˆ‘æ˜¯æ ‡é¢˜",
									titleepic:"../../static/demo/datapic/14.jpg",
									video:false,
									shaer:false,
									path:"æ·±åœ³ ç½—æ¹–",
									shaernum:20,
									commonnum:30,
									goodnum:50
								},
							]
					// èµ‹å€¼
					this.tablist[this.tabIndex].list = arr
					// å…³é—­ä¸‹æ‹‰åˆ·æ–°
					uni.stopPullDownRefresh()
				}, 2000);
			},
			// ä¸Šæ‹‰åŠ è½½
			loadmore(){
				if(this.tablist[this.tabIndex].loadtext != "åŠ è½½æ›´å¤š"){return}
				this.tablist[this.tabIndex].loadtext = "åŠ è½½ä¸­...";
				// è·å–æ•°æ®
				setTimeout(()=>{
					//è·å–å®Œæˆ
					let obj = {
							userpic:"../../static/demo/userpic/10.jpg",
							username:"ä¸‰é±¼å…ˆç”Ÿ",
							sex:1, // 0ç”· 1å¥³
							age:25,
							isguanzhu:false,
							title:"æˆ‘æ˜¯æ ‡é¢˜",
							titleepic:"../../static/demo/datapic/14.jpg",
							video:false,
							shaer:false,
							path:"æ·±åœ³ ç½—æ¹–",
							shaernum:20,
							commonnum:30,
							goodnum:50
					};
					this.tablist[this.tabIndex].list.push(obj);
					this.tablist[this.tabIndex].loadtext = "åŠ è½½æ›´å¤š";
				},1000)
				// this.tablist[this.tabIndex].loadtext = "æ²¡æœ‰æ›´å¤šæ•°æ®äº†"
			},
			// tabbarç‚¹å‡»æŒ‰é’®
			tobtap(index){
				this.tabIndex = index
			}
		}
	}
</script>

<style>

</style>
